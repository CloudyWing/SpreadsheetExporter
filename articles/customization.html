<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>自訂樣式 | SpreadsheetExporter Docs </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="自訂樣式 | SpreadsheetExporter Docs ">
      
      
      <link rel="icon" href="../images/logo.png">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/CloudyWing/SpreadsheetExporter/blob/main/docs/articles/customization.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../images/logo.png" alt="SpreadsheetExporter Docs">
            SpreadsheetExporter Docs
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="自訂樣式">自訂樣式</h1>

<p>專案使用的儲存格樣式皆定義在 <code>SpreadsheetManager.DefaultCellStyles</code>，提供預設樣式給不同元件使用。</p>
<h2 id="預設樣式">預設樣式</h2>
<p><code>CellStyleConfiguration</code> 提供以下預設樣式：</p>
<table>
<thead>
<tr>
<th>樣式</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CellStyle</code></td>
<td>預設儲存格樣式</td>
</tr>
<tr>
<td><code>GridCellStyle</code></td>
<td><code>GridTemplate</code> 使用的預設樣式</td>
</tr>
<tr>
<td><code>HeaderStyle</code></td>
<td><code>RecordSetTemplate</code> 標題列使用的預設樣式</td>
</tr>
<tr>
<td><code>FieldStyle</code></td>
<td><code>RecordSetTemplate</code> 資料列使用的預設樣式</td>
</tr>
</tbody>
</table>
<h2 id="更改預設樣式">更改預設樣式</h2>
<h3 id="基於現有樣式修改">基於現有樣式修改</h3>
<p>以下範例將所有預設樣式的字體大小放大：</p>
<pre><code class="lang-csharp">SpreadsheetManager.DefaultCellStyles = new CellStyleConfiguration((setuper) =&gt; {
    CellStyleConfiguration oldCellStyles = SpreadsheetManager.DefaultCellStyles;
    
    setuper.CellStyle = oldCellStyles.CellStyle with {
        Font = oldCellStyles.CellStyle.Font with { Size = 16 }
    };
    
    setuper.GridCellStyle = oldCellStyles.GridCellStyle with {
        Font = oldCellStyles.GridCellStyle.Font with { Size = 14 }
    };
    
    setuper.HeaderStyle = oldCellStyles.HeaderStyle with {
        Font = oldCellStyles.HeaderStyle.Font with { Size = 14 }
    };
    
    setuper.FieldStyle = oldCellStyles.FieldStyle with {
        Font = oldCellStyles.FieldStyle.Font with { Size = 14 }
    };
});
</code></pre>
<h3 id="完整自訂">完整自訂</h3>
<p>您也可以使用 <code>new CellStyle()</code> 完整自訂所有屬性：</p>
<pre><code class="lang-csharp">SpreadsheetManager.DefaultCellStyles = new CellStyleConfiguration((setuper) =&gt; {
    CellFont customFont = new CellFont(
        fontName: &quot;微軟正黑體&quot;,
        size: 12,
        color: Color.Black,
        style: FontStyles.None
    );
    
    setuper.CellStyle = new CellStyle(
        horizontalAlignment: HorizontalAlignment.Left,
        verticalAlignment: VerticalAlignment.Middle,
        hasBorder: false,
        wrapText: false,
        backgroundColor: Color.Empty,
        font: customFont
    );
    
    // ... 設定其他樣式 ...
});
</code></pre>
<h2 id="從設定檔讀取樣式">從設定檔讀取樣式</h2>
<h3 id="設定檔結構">設定檔結構</h3>
<p>在專案中建立 <code>Spreadsheet.json</code> 並設定「複製到輸出目錄」：</p>
<pre><code class="lang-json">{
    &quot;Spreadsheet&quot;: {
        &quot;Cell&quot;: {
            &quot;HorizontalAlignment&quot;: &quot;Center&quot;,
            &quot;VerticalAlignment&quot;: &quot;Middle&quot;,
            &quot;HasBorder&quot;: false,
            &quot;WrapText&quot;: false,
            &quot;Font&quot;: {
                &quot;FontName&quot;: &quot;新細明體&quot;,
                &quot;FontSize&quot;: 10,
                &quot;IsBold&quot;: false,
                &quot;IsItalic&quot;: false,
                &quot;HasUnderline&quot;: false,
                &quot;IsStrikeout&quot;: false
            }
        }
    }
}
</code></pre>
<h3 id="載入設定">載入設定</h3>
<p>在 <code>Program.cs</code> 中讀取並套用設定：</p>
<pre><code class="lang-csharp">public class ConfigSettings {
    public CellSettings Cell { get; set; }
}

public class CellSettings {
    public HorizontalAlignment HorizontalAlignment { get; set; }
    public VerticalAlignment VerticalAlignment { get; set; }
    public bool HasBorder { get; set; }
    public bool WrapText { get; set; }
    public FontSettings Font { get; set; }
}

public class FontSettings {
    public string FontName { get; set; }
    public short FontSize { get; set; }
    public bool IsBold { get; set; }
    public bool IsItalic { get; set; }
    public bool HasUnderline { get; set; }
    public bool IsStrikeout { get; set; }
}

// 建立設定載入器
IConfigurationRoot config = new ConfigurationBuilder()
    .SetBasePath(AppDomain.CurrentDomain.BaseDirectory)
    .AddJsonFile(&quot;Spreadsheet.json&quot;, optional: false, reloadOnChange: true)
    .Build();

// 設定自動重新載入
ChangeToken.OnChange(() =&gt; config.GetReloadToken(), () =&gt; {
    Initialize();
});

Initialize();

void Initialize() {
    ConfigSettings configSettings = config.GetSection(&quot;Spreadsheet&quot;).Get&lt;ConfigSettings&gt;();
    CellSettings cellSettings = configSettings.Cell;
    
    // 組合字型樣式
    FontStyles fontStyle = FontStyles.None;
    if (cellSettings.Font.IsBold) {
        fontStyle |= FontStyles.IsBold;
    }
    if (cellSettings.Font.IsItalic) {
        fontStyle |= FontStyles.IsItalic;
    }
    if (cellSettings.Font.HasUnderline) {
        fontStyle |= FontStyles.HasUnderline;
    }
    if (cellSettings.Font.IsStrikeout) {
        fontStyle |= FontStyles.IsStrikeout;
    }
    
    // 建立儲存格樣式
    CellStyle cellStyle = new CellStyle(
        cellSettings.HorizontalAlignment,
        cellSettings.VerticalAlignment,
        cellSettings.HasBorder,
        cellSettings.WrapText,
        Color.Empty,
        new CellFont(
            cellSettings.Font.FontName,
            cellSettings.Font.FontSize,
            Color.Black,
            fontStyle
        )
    );
    
    // 套用至全域設定
    SpreadsheetManager.DefaultCellStyles = new CellStyleConfiguration((setuper) =&gt; {
        setuper.CellStyle = cellStyle;
        setuper.GridCellStyle = cellStyle;
        setuper.HeaderStyle = cellStyle with {
            Font = cellStyle.Font with {
                Style = cellStyle.Font.Style | FontStyles.IsBold
            },
            HorizontalAlignment = HorizontalAlignment.Center,
            HasBorder = true
        };
        setuper.FieldStyle = cellStyle with {
            HorizontalAlignment = HorizontalAlignment.General,
            HasBorder = true
        };
    });
}
</code></pre>
<div class="TIP">
<h5>Tip</h5>
<p>使用 <code>ChangeToken.OnChange</code> 可在設定檔變更時自動重新載入樣式，無需重新啟動應用程式。</p>
</div>
<h2 id="相關主題">相關主題</h2>
<ul>
<li><a href="getting-started.html">入門指南</a> - 了解 SpreadsheetManager 的設定時機</li>
<li><a href="exporters.html">Exporters</a> - 學習如何在 Exporter 層級套用全域樣式</li>
<li><a href="sheeters.html">Sheeters</a> - 了解 Sheeter 如何使用預設樣式</li>
<li><a href="templates.html">Templates</a> - 學習在 Template 中覆寫或使用自訂樣式</li>
</ul>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/CloudyWing/SpreadsheetExporter/blob/main/docs/articles/customization.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
